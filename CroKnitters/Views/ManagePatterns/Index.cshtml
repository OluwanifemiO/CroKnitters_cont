@model CroKnitters.Entities.Feed;

@{
    ViewData["Title"] = "Home Page";
}

<div class="flex">
    <div class="container p-4">
        <!--Patterns-->
        <h3 class="text-2xl font-extrabold text-left">Patterns</h3>
        <div class="grid grid-cols-4 gap-4 ">

            @foreach (var pattern in Model.Patterns)
            {
                <div>
                    <div>
                        @if (pattern.Images != null && pattern.Images.Any())
                        {
                            @if (pattern.ActivePattern.PatternImages.Count > 0)
                            {
                                var firstImageSrc = pattern.Images.First();
                                <div class="aspect-w-1 aspect-h-1 w-full overflow-hidden rounded-lg bg-gray-200 xl:aspect-w-7 xl:aspect-h-8">
                                    <img src="@("~/img/patterns/"+firstImageSrc)" asp-append-version="true" width="300px" height="300px" alt="Pattern image" class="h-full w-full object-cover object-center group-hover:opacity-75">
                                </div>
                            }
                        }
                    </div>
                    <div class="m-2 text-center font-bold">@pattern.ActivePattern.PatternName</div>
                    <div class="text-center">
                        <button class="text-red-500" style="color: blue; text-decoration: underline;" onclick="confirmDelete('@pattern.ActivePattern.PatternId')">Delete</button>
                    </div>
                    <script>
                        function confirmDelete(patternId) {
                            var result = confirm("Are you sure you want to delete the pattern?");
                            if (result) {
                                $.ajax({
                                    url: '@Url.Action("DeletePattern", "Pattern")',
                                    type: 'POST',
                                    data: { id: patternId },
                                    success: function (data) {
                                        // Optionally, you can handle success response here
                                        // For example, you can reload the page to reflect changes
                                        location.reload();
                                    },
                                    error: function (xhr, status, error) {
                                        // Handle error if any
                                        console.error(xhr.responseText);
                                    }
                                });
                            }
                        }
                    </script>
                </div>
            }
        </div>
    </div>
</div>


<div class="flex">
    <div class="container p-4">
        <!-- Projects -->
        <h3 class="text-2xl font-extrabold text-left">Projects</h3>
        <div class="grid grid-cols-4 gap-4">

            @foreach (var project in Model.Projects)
            {
                <div>
                    <div>
                        @if (project.Images != null && project.Images.Any())
                        {
                            @if (project.ActiveProject.ProjectImages.Count > 0)
                            {
                                var firstImageSrc = project.Images.First();
                                <div class="aspect-w-1 aspect-h-1 w-full overflow-hidden rounded-lg bg-gray-200 xl:aspect-w-7 xl:aspect-h-8">
                                    <img src="@("~/img/projects/"+firstImageSrc)" asp-append-version="true" width="300px" height="300px" alt="Project image" class="h-full w-full object-cover object-center group-hover:opacity-75">
                                </div>
                            }
                        }
                    </div>
                    <div class="m-2 text-center font-bold">@project.ActiveProject.ProjectName</div>
                    <div class="text-center">
                        <button class="text-red-500" style="color: blue; text-decoration: underline;" onclick="confirmDelete('@project.ActiveProject.ProjectId')">Delete</button>
                    </div>
                    <script>
                        function confirmDelete(projectId) {
                            var result = confirm("Are you sure you want to delete the project?");
                            if (result) {
                                $.ajax({
                                    url: '@Url.Action("DeleteProject", "Project")',
                                    type: 'POST',
                                    data: { id: projectId },
                                    success: function (data) {
                                        // Optionally, you can handle success response here
                                        // For example, you can reload the page to reflect changes
                                        location.reload();
                                    },
                                    error: function (xhr, status, error) {
                                        // Handle error if any
                                        console.error(xhr.responseText);
                                    }
                                });
                            }
                        }
                    </script>
                </div>
            }
        </div>
    </div>
</div>